ylab("Horas anuales")
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=0)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=0, size=3)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=0, size=3, alpha=.95,fill='lightblue',color='lightblue4')
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=15, size=3, alpha=.95,fill='lightblue',color='lightblue4')
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=22, size=3, alpha=.95,fill='lightblue',color='lightblue4')
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=30, y =500, shape=22, size=5, alpha=.3,fill='pink',color='red')
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=30, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')
library(reshape2)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=30, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("Distribución de la velocidad del viento a 10 metros", xmin = 35, xmax = 40,
ymin = 450, ymax = 550)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=30, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
geom_point()+
annotate("Distribución de la velocidad del viento a 10 metros", xmin = 35, xmax = 40,
ymin = 450, ymax = 550)
annotate("text",label="Distribución de la velocidad del viento a 10 metros", xmin = 35, xmax = 40,
ymin = 450, ymax = 550)
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 35, y = 550)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=30, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 35, y = 550)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=30, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=30, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 550)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=15, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=15, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 550)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 450)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=15, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=15, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)+
theme_bw()
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros",
x = 30, y = 500, color="lightblue")+
annotate("text",label="Distribución de la velocidad del viento a 10 metros",
x = 30, y = 400, color="pink")+
theme_bw()
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)+
theme_bw()
path_here<-paste0(here(),"/barplot/")
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)+
theme_bw()
ggsave(paste0(path_here,"barplotcomparativo",zoom_in,".tiff"), device = "tiff", dpi=1200,width =7, height =7, units = 'in')
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)+
theme_bw()
ggsave(paste0(path_here,"barplotcomparativo.tiff"), device = "tiff", dpi=1200,width =7, height =7, units = 'in')
path_here<-paste0(here(),"/barplot/")
dir.create(path_here)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)+
theme_bw()
ggsave(paste0(path_here,"barplotcomparativo.tiff"), device = "tiff", dpi=1200,width =7, height =7, units = 'in')
path_here<-paste0(here(),"/barplot/")
dir.create(path_here)
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)+
theme_bw()
ggsave(paste0(path_here,"barplotcomparativo.tiff"), device = "tiff", dpi=1200,width =10, height =7, units = 'in')
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)+
theme_bw()
ggsave(paste0(path_here,"barplotcomparativo.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
ggplot(frame_barplot)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_50),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(frame_barplot)),y=Dist_10),stat = "identity", alpha=.3,fill='pink',color='red',show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)+
theme_bw()
ggsave(paste0(path_here,"barplotcomparativo.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
tabla_localizacion_altura[tabla_localizacion_altura$wd<350 $ tabla_localizacion_altura>314,]
tabla_localizacion_altura[tabla_localizacion_altura$wd < 350 $ tabla_localizacion_altura > 314,]
tabla_localizacion_altura[tabla_localizacion_altura$wd < 350 & tabla_localizacion_altura > 314,]
tabla_localizacion_NO<-tabla_localizacion_altura[tabla_localizacion_altura$wd < 350 & tabla_localizacion_altura$wd > 314,]
tabla_localizacion_NO<-tabla_localizacion_altura[tabla_localizacion_altura$wd < 350 & tabla_localizacion_altura$wd > 314,]
distribuciones_velocidad_NO<- table(tabla_localizacion_NO$grup_vel)
dist_total_NO<-sum(distribuciones_velocidad_NO)
distribuciones_velocidad_porcentaje_NO<- distribuciones_velocidad_NO/dist_total_NO
distribuciones_velocidad_anual_NO<- distribuciones_velocidad_porcentaje_NO*8600
distribuciones_velocidad_anual_NO
as.numeric(row.names(distribuciones_velocidad_anual_NO)
as.numeric(row.names(distribuciones_velocidad_anual_NO))
distribuciones_velocidad_anual_NO<- t(distribuciones_velocidad_porcentaje_NO*8600)
as.numeric(row.names(distribuciones_velocidad_anual_NO))
distribuciones_velocidad_anual_NO
distribuciones_velocidad_anual_NO<- distribuciones_velocidad_porcentaje_NO*8600
dim(distribuciones_velocidad_anual_NO)
as.numeric(names(distribuciones_velocidad_anual_NO))
ggplot(distribuciones_velocidad_anual_NO)+
geom_bar(aes(x=as.numeric(names(distribuciones_velocidad_anual_NO)),y=distribuciones_velocidad_anual_NO),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
geom_point(x=18, y =500, shape=22, size=5, alpha=.95,fill='lightblue',color='lightblue4')+
geom_point(x=18, y =400, shape=22, size=5, alpha=.3,fill='pink',color='red')+
annotate("text",label="Distribución de la velocidad del viento a 50 metros", x = 30, y = 500)+
annotate("text",label="Distribución de la velocidad del viento a 10 metros", x = 30, y = 400)+
theme_bw()
ggplot(distribuciones_velocidad_anual_NO)+
geom_bar(aes(x=as.numeric(names(distribuciones_velocidad_anual_NO)),y=distribuciones_velocidad_anual_NO),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)
tabla_NO<- cbind(as.numeric(names(distribuciones_velocidad_anual_NO)), distribuciones_velocidad_anual_NO)
head(tabla_NO)
tabla_NO<- cbind(distribuciones_velocidad_anual_NO)
head(tabla_NO)
ggplot(distribuciones_velocidad_anual_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=tabla_NO[,1]),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4', show.legend = T)
as.numeric(row.names(tabla_NO))
tabla_NO[,1]
ggplot(distribuciones_velocidad_anual_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=tabla_NO[,1]),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=tabla_NO[,1]),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')
tabla_NO<-as.data.frame( cbind(distribuciones_velocidad_anual_NO))
names(tabla_NO)<- "distribucion"
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')
dist_total_NO
distribuciones_velocidad_porcentaje_NO<- distribuciones_velocidad_NO/dist_total
distribuciones_velocidad_anual_NO<- distribuciones_velocidad_porcentaje_NO*8600
tabla_NO<-as.data.frame( cbind(distribuciones_velocidad_anual_NO))
names(tabla_NO)<- "distribucion"
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento dirección Noroeste")
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento dirección Noroeste")+
theme_bw()
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento  \n dirección Noroeste")+
theme_bw()
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento  \n dirección Noroeste", hjust=0.5)+
theme_bw()
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento  \n dirección Noroeste", hjust=0.5)+
theme(plot.title = element_text(hjust = 0.5))+
theme_bw()
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento  \n dirección Noroeste")+
theme(plot.title = element_text(hjust = 0.5))+
theme_bw()
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento  \n dirección Noroeste")+
theme(plot.title = element_text(hjust = 0.5))+
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento  \n dirección Noroeste")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento  \n dirección Noroeste")+
theme_bw(plot.title = element_text(hjust = 0.5))
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento  \n dirección Noroeste")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_NO)+
geom_bar(aes(x=as.numeric(row.names(tabla_NO)),y=distribucion),
stat = "identity",alpha=.95,fill='lightblue',color='lightblue4')+
xlab("Velocidad del viento (m/s)")+
ylab("Horas anuales") +
ggtitle("Distribución de la velocidad del viento  \n dirección Noroeste")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotNO.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
source('~/ProyectoRoseo/Procesado_datos_ploteos.R', encoding = 'UTF-8')
###ploteo de la curva Potencia, Vviento. Teniendo en cuenta que hay que
##añadir los limites de x e y para la grafica y que además
##devuelve un data.frame con los coeficientes. Para posteriormente
## hacer lo que queramos con ellos.
## la formula de ajuste es y ~ b + a*x^3
limitex<- c(0,11)
limitey<- c(0,10)
coeficientes_Curva_P_V<- grafica_Potencia_V(df,limitex,limitey)
## Elaboracion Grafica Potencia_m/s y devuelve los coeficientes
##de la regresion.
grafica_Potencia_V<-function(df,xlimite,ylimite){
select_groups <- function(data, groups) {
data[sort(unlist(attr(data, "indices")[ groups ])) + 1, ]
}
group_number<-length(attr(group_by(df,experimento,angulo), "group"))
lista_watts_Vviento<- list()
nombres_expr<-vector()
for (groups_ind in 1:group_number) {
xx<- df %>% group_by(.,experimento,angulo) %>% select_groups(groups_ind)
nombre_1<-as.character(xx$experimento[1])
nombre_2<-as.character(xx$angulo[1])
nombre<-paste(nombre_1,nombre_2,sep = "_")
percentaje_number<-length(attr(group_by(xx,porcentaje), "group") )
xx_percentaje<-list()
for (per in 1:percentaje_number) {
xx_perc<- xx %>% group_by(.,porcentaje) %>% select_groups(per)
xx_perc<-cbind(xx_perc$cp_est,xx_perc$watts,xx_perc$Vviento_estandar)
colnames(xx_perc)<- c("cp","watts", "Vviento")
xx_percentaje[[per]]<- xx_perc
}
lista_watts_Vviento[[groups_ind]]<- xx_percentaje
nombres_expr[groups_ind]<- nombre
}
names(lista_watts_Vviento)<- nombres_expr
lista_watts_Vviento_max<-list()
for (i in 1:length(lista_watts_Vviento)) {
df_watts_Vviento<- data.frame(matrix(unlist(lapply(lista_watts_Vviento[[i]],
function(x) x[which.max(x[,1]),2:3])),
nrow=6, byrow=T))
names(df_watts_Vviento)<- c("Watss","Vviento")
lista_watts_Vviento_max[[i]]<- df_watts_Vviento
}
names(lista_watts_Vviento_max)<- nombres_expr
dir.create(paste0(here(),"/graficos_Potencia_V/"))
#jpeg(paste0(here(),"/graficos_Potencia_V/grafica_Potencia_V.jpeg"))
tiff(paste0(here(),"/graficos_Potencia_V/grafica_Potencia_V.tiff"), width = 7, height =7, units = 'in', res = 300)
colores<- c("orange","red","blue","dodgerblue4","purple","black")
pch_dif<-c(0:5)
correlacion<- vector()
lista_coef<-list()
for(i in 1:length(lista_watts_Vviento_max)){
#en caso de que sea mejor añadir el origen
#x<- c(0,lambda_Cp[[i]][,2])
#y<- c(0,lambda_Cp[[i]][,1])
x<- lista_watts_Vviento_max[[i]][,2]
y<- lista_watts_Vviento_max[[i]][,1]
fit_curva<-nls(y~b+a*x^3,start = list(a=0, b=0))
xx <- seq(min(x),xlimite[2], by=0.1)
plot(NULL,xlim=xlimite,
ylim = ylimite,cex=0.005, yaxt ="n",
xlab = "Velocidad del viento (m/s)", ylab = "Potencia (W)", bty='L')
title(main= "Curvas de potencia")
par(new=T)
lines(xx, predict(fit_curva, data.frame(x=xx)), col=colores[i],lwd=1,lty=2)
points(x,y, pch= pch_dif[i])
par(new=T)
correlacion[i]<- cor(y,predict(fit_curva))
lista_coef[[i]]<- coef(fit_curva)
}
axis(2, at=seq(0,ylimite[2], by=round(ylimite[2]/7,0)),las=2)
titulos_graficos<-function(df){
group_number<-length(attr(group_by(df,experimento,angulo,porcentaje), "group"))
lista_rpm_resistencia<- list()
nombres_lista<- vector()
titulos_grafico<- vector()
tabladenombres<- matrix(-31,ncol = 3, nrow = group_number)
for (grupos in 1:group_number) {
grupos_rpm_resistencia<- df %>% group_by(.,experimento,angulo,porcentaje) %>% select_groups(grupos)
tabla_resistencia_rpm<- as.data.frame(cbind(as.numeric(grupos_rpm_resistencia$RPM),as.data.frame(grupos_rpm_resistencia$resistencia)))
colnames(tabla_resistencia_rpm)<- c("RPM", "Omhnios")
nombre_tabla<- unique(paste(grupos_rpm_resistencia$experimento,grupos_rpm_resistencia$angulo,grupos_rpm_resistencia$porcentaje,sep = "_"))
if(is.na(grupos_rpm_resistencia$angulo)){
titulo_graph<- unique(paste0(grupos_rpm_resistencia$experimento))
}else{
titulo_graph<- unique(paste0(grupos_rpm_resistencia$experimento,"-",grupos_rpm_resistencia$angulo,"º"))
}
titulos_grafico[grupos]<- titulo_graph
lista_rpm_resistencia[[grupos]]<- tabla_resistencia_rpm
nombres_lista[grupos]<- nombre_tabla
tabladenombres[grupos,1]<-as.character(grupos_rpm_resistencia$experimento[1])
tabladenombres[grupos,2]<- as.character(grupos_rpm_resistencia$angulo[1])
tabladenombres[grupos,3]<- as.character(grupos_rpm_resistencia$porcentaje[1])
}
return(unique(titulos_grafico))
}
nombres_df<- titulos_graficos(df)
leyenda<- paste0(nombres_df," (Cor= ",round(correlacion,4),")")
legend("topleft",y.intersp = 0.75,seg.len = 0.9,
bty="n", bg="transparent",inset=c(0,0),
legend = leyenda,lty = c(2,2,2,2,2),lwd = c(2,2,2,2,2),col = colores[1:5],ncol = 1,cex = 1)
dev.off()
tabladenombress<-function(df){
group_number<-length(attr(group_by(df,experimento,angulo), "group"))
tabladenombres<- matrix(-31,ncol = 2, nrow = group_number)
for (grupos in 1:group_number) {
grupos_rpm_resistencia<- df %>% group_by(.,experimento,angulo) %>% select_groups(grupos)
tabladenombres[grupos,1]<-as.character(grupos_rpm_resistencia$experimento[1])
tabladenombres[grupos,2]<- as.character(grupos_rpm_resistencia$angulo[1])
}
return(as.data.frame(tabladenombres))
}
tablanombres<-tabladenombress(df)
coeficientes_P_V<-data.frame(matrix(unlist(lista_coef),nrow=5, byrow=T))
coef_tabla<- cbind(tablanombres,coeficientes_P_V)
names(coef_tabla)<-c("Experimento","Angulo","a","b")
return(coef_tabla)
}
coeficientes_Curva_P_V<- grafica_Potencia_V(df,limitex,limitey)
###ploteo de la curva Potencia, Vviento. Teniendo en cuenta que hay que
##añadir los limites de x e y para la grafica y que además
##devuelve un data.frame con los coeficientes. Para posteriormente
## hacer lo que queramos con ellos.
## la formula de ajuste es y ~ b + a*x^3
limitex<- c(0,20)
limitey<- c(0,50)
coeficientes_Curva_P_V<- grafica_Potencia_V(df,limitex,limitey)
###ploteo de la curva Potencia, Vviento. Teniendo en cuenta que hay que
##añadir los limites de x e y para la grafica y que además
##devuelve un data.frame con los coeficientes. Para posteriormente
## hacer lo que queramos con ellos.
## la formula de ajuste es y ~ b + a*x^3
limitex<- c(0,40)
limitey<- c(0,50)
coeficientes_Curva_P_V<- grafica_Potencia_V(df,limitex,limitey)
###ploteo de la curva Potencia, Vviento. Teniendo en cuenta que hay que
##añadir los limites de x e y para la grafica y que además
##devuelve un data.frame con los coeficientes. Para posteriormente
## hacer lo que queramos con ellos.
## la formula de ajuste es y ~ b + a*x^3
limitex<- c(0,30)
limitey<- c(0,50)
coeficientes_Curva_P_V<- grafica_Potencia_V(df,limitex,limitey)
###ploteo de la curva Potencia, Vviento. Teniendo en cuenta que hay que
##añadir los limites de x e y para la grafica y que además
##devuelve un data.frame con los coeficientes. Para posteriormente
## hacer lo que queramos con ellos.
## la formula de ajuste es y ~ b + a*x^3
limitex<- c(0,20)
limitey<- c(0,40)
coeficientes_Curva_P_V<- grafica_Potencia_V(df,limitex,limitey)
