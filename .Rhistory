geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =200, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =180, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =160, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =140, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =120, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 200)+
annotate("text",label="Concentrador 45º", x = 30, y = 180)+
annotate("text",label="Concentrador 70º", x = 30, y = 160)+
annotate("text",label="Pared", x = 27, y = 140)+
annotate("text",label="Piloto", x = 27, y = 120)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =200, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =180, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =160, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =140, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =120, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 200)+
annotate("text",label="Concentrador 45º", x = 30, y = 180)+
annotate("text",label="Concentrador 70º", x = 30, y = 160)+
annotate("text",label="Pared", x = 28, y = 140)+
annotate("text",label="Piloto", x = 28, y = 120)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =200, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =180, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =160, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =140, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =120, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 200)+
annotate("text",label="Concentrador 45º", x = 30, y = 180)+
annotate("text",label="Concentrador 70º", x = 30, y = 160)+
annotate("text",label="Pared", x = 27.5, y = 140)+
annotate("text",label="Piloto", x = 27.5, y = 120)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotenergíacomparativa_estandar.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
barplot_energias_estandar<-function(){
tabla_energia_est<-as.data.frame(matrix(unlist(lapply(lista_energias,"[",,4), use.names = F), byrow = F,ncol = 5))
names(tabla_energia_est)<- names(lista_energias)
row.names(tabla_energia_est)<- names(distribuciones_velocidad_anual)
path_here<-paste0(here(),"/barplot/")
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =200, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =180, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =160, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =140, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =120, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 200)+
annotate("text",label="Concentrador 45º", x = 30, y = 180)+
annotate("text",label="Concentrador 70º", x = 30, y = 160)+
annotate("text",label="Pared", x = 27.5, y = 140)+
annotate("text",label="Piloto", x = 27.5, y = 120)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotenergíacomparativa_estandar.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
}
barplot_energias_estandar()
barplot_energias_medida<-function(){
tabla_energia_est<-as.data.frame(matrix(unlist(lapply(lista_energias,"[",,5), use.names = F), byrow = F,ncol = 5))
names(tabla_energia_est)<- names(lista_energias)
row.names(tabla_energia_est)<- names(distribuciones_velocidad_anual)
path_here<-paste0(here(),"/barplot/")
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =200, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =180, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =160, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =140, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =120, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 200)+
annotate("text",label="Concentrador 45º", x = 30, y = 180)+
annotate("text",label="Concentrador 70º", x = 30, y = 160)+
annotate("text",label="Pared", x = 27.5, y = 140)+
annotate("text",label="Piloto", x = 27.5, y = 120)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotenergíacomparativa_medida.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
}
barplot_energias_medida()
tabla_energia_est<-as.data.frame(matrix(unlist(lapply(lista_energias,"[",,5), use.names = F), byrow = F,ncol = 5))
names(tabla_energia_est)<- names(lista_energias)
row.names(tabla_energia_est)<- names(distribuciones_velocidad_anual)
path_here<-paste0(here(),"/barplot/")
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =200, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =180, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =160, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =140, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =120, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 200)+
annotate("text",label="Concentrador 45º", x = 30, y = 180)+
annotate("text",label="Concentrador 70º", x = 30, y = 160)+
annotate("text",label="Pared", x = 27.5, y = 140)+
annotate("text",label="Piloto", x = 27.5, y = 120)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1500, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1300, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 200)+
annotate("text",label="Concentrador 45º", x = 30, y = 180)+
annotate("text",label="Concentrador 70º", x = 30, y = 160)+
annotate("text",label="Pared", x = 27.5, y = 140)+
annotate("text",label="Piloto", x = 27.5, y = 120)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1500, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1300, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 1500)+
annotate("text",label="Concentrador 45º", x = 30, y = 1300)+
annotate("text",label="Concentrador 70º", x = 30, y = 1100)+
annotate("text",label="Pared", x = 27.5, y = 900)+
annotate("text",label="Piloto", x = 27.5, y = 700)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1500, shape=22, size=5, alpha=.9,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1300, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 1500)+
annotate("text",label="Concentrador 45º", x = 30, y = 1300)+
annotate("text",label="Concentrador 70º", x = 30, y = 1100)+
annotate("text",label="Pared", x = 27.5, y = 900)+
annotate("text",label="Piloto", x = 27.5, y = 700)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1500, shape=22, size=5, alpha=.9,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1300, shape=22, size=5, alpha=.2,fill='pink',color='red')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 1500)+
annotate("text",label="Concentrador 45º", x = 30, y = 1300)+
annotate("text",label="Concentrador 70º", x = 30, y = 1100)+
annotate("text",label="Pared", x = 27.5, y = 900)+
annotate("text",label="Piloto", x = 27.5, y = 700)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1500, shape=22, size=5, alpha=.9,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1300, shape=22, size=5, alpha=.1,fill='pink',color='red')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 1500)+
annotate("text",label="Concentrador 45º", x = 30, y = 1300)+
annotate("text",label="Concentrador 70º", x = 30, y = 1100)+
annotate("text",label="Pared", x = 27.5, y = 900)+
annotate("text",label="Piloto", x = 27.5, y = 700)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1300, shape=22, size=5, alpha=.1,fill='pink',color='red')+
geom_point(x=25, y =1500, shape=22, size=5, alpha=.9,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 1500)+
annotate("text",label="Concentrador 45º", x = 30, y = 1300)+
annotate("text",label="Concentrador 70º", x = 30, y = 1100)+
annotate("text",label="Pared", x = 27.5, y = 900)+
annotate("text",label="Piloto", x = 27.5, y = 700)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1300, shape=22, size=5, alpha=.1,fill='pink',color='red')+
geom_point(x=25, y =1500, shape=22, size=5, alpha=.9,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 1500)+
annotate("text",label="Concentrador 45º", x = 30, y = 1300)+
annotate("text",label="Concentrador 70º", x = 30, y = 1100)+
annotate("text",label="Pared", x = 27.5, y = 900)+
annotate("text",label="Piloto", x = 27.5, y = 700)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
barplot_energias_medida<-function(){
tabla_energia_est<-as.data.frame(matrix(unlist(lapply(lista_energias,"[",,5), use.names = F), byrow = F,ncol = 5))
names(tabla_energia_est)<- names(lista_energias)
row.names(tabla_energia_est)<- names(distribuciones_velocidad_anual)
path_here<-paste0(here(),"/barplot/")
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1300, shape=22, size=5, alpha=.1,fill='pink',color='red')+
geom_point(x=25, y =1500, shape=22, size=5, alpha=.9,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 1500)+
annotate("text",label="Concentrador 45º", x = 30, y = 1300)+
annotate("text",label="Concentrador 70º", x = 30, y = 1100)+
annotate("text",label="Pared", x = 27.5, y = 900)+
annotate("text",label="Piloto", x = 27.5, y = 700)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotenergíacomparativa_medida.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
}
barplot_energias_medida(    )
barplot_energias_medida()
colSums(tabla_energia_est)
energia_anual_est<-barplot_energias_estandar()
energia_anual_med<-barplot_energias_medida()
energia_anual_est
energia_anual_med
colSums(tabla_energia_est)
barplot_energias_estandar<-function(){
tabla_energia_est<-as.data.frame(matrix(unlist(lapply(lista_energias,"[",,4), use.names = F), byrow = F,ncol = 5))
names(tabla_energia_est)<- names(lista_energias)
row.names(tabla_energia_est)<- names(distribuciones_velocidad_anual)
path_here<-paste0(here(),"/barplot/")
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =200, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =180, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =160, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =140, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =120, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 200)+
annotate("text",label="Concentrador 45º", x = 30, y = 180)+
annotate("text",label="Concentrador 70º", x = 30, y = 160)+
annotate("text",label="Pared", x = 27.5, y = 140)+
annotate("text",label="Piloto", x = 27.5, y = 120)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotenergíacomparativa_estandar.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
return(as.data.frame(colSums(tabla_energia_est)))
}
energia_anual_est<-barplot_energias_estandar()
barplot_energias_estandar<-function(){
tabla_energia_est<-as.data.frame(matrix(unlist(lapply(lista_energias,"[",,4), use.names = F), byrow = F,ncol = 5))
names(tabla_energia_est)<- names(lista_energias)
row.names(tabla_energia_est)<- names(distribuciones_velocidad_anual)
path_here<-paste0(here(),"/barplot/")
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =200, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =180, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =160, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =140, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =120, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 200)+
annotate("text",label="Concentrador 45º", x = 30, y = 180)+
annotate("text",label="Concentrador 70º", x = 30, y = 160)+
annotate("text",label="Pared", x = 27.5, y = 140)+
annotate("text",label="Piloto", x = 27.5, y = 120)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotenergíacomparativa_estandar.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
return(as.data.frame(colSums(tabla_energia_est)))
}
barplot_energias_medida<-function(){
tabla_energia_est<-as.data.frame(matrix(unlist(lapply(lista_energias,"[",,5), use.names = F), byrow = F,ncol = 5))
names(tabla_energia_est)<- names(lista_energias)
row.names(tabla_energia_est)<- names(distribuciones_velocidad_anual)
path_here<-paste0(here(),"/barplot/")
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1300, shape=22, size=5, alpha=.1,fill='pink',color='red')+
geom_point(x=25, y =1500, shape=22, size=5, alpha=.9,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 1500)+
annotate("text",label="Concentrador 45º", x = 30, y = 1300)+
annotate("text",label="Concentrador 70º", x = 30, y = 1100)+
annotate("text",label="Pared", x = 27.5, y = 900)+
annotate("text",label="Piloto", x = 27.5, y = 700)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotenergíacomparativa_medida.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
return(colSums(tabla_energia_est))
}
energia_anual_est<-barplot_energias_estandar()
energia_anual_med<-barplot_energias_medida()
energia_anual_est
energia_anual_med
barplot_energias_medida<-function(){
tabla_energia_est<-as.data.frame(matrix(unlist(lapply(lista_energias,"[",,5), use.names = F), byrow = F,ncol = 5))
names(tabla_energia_est)<- names(lista_energias)
row.names(tabla_energia_est)<- names(distribuciones_velocidad_anual)
path_here<-paste0(here(),"/barplot/")
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1300, shape=22, size=5, alpha=.1,fill='pink',color='red')+
geom_point(x=25, y =1500, shape=22, size=5, alpha=.9,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 1500)+
annotate("text",label="Concentrador 45º", x = 30, y = 1300)+
annotate("text",label="Concentrador 70º", x = 30, y = 1100)+
annotate("text",label="Pared", x = 27.5, y = 900)+
annotate("text",label="Piloto", x = 27.5, y = 700)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotenergíacomparativa_medida.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
return(as.data.frame(colSums(tabla_energia_est)))
}
energia_anual_est<-barplot_energias_estandar()
energia_anual_med<-barplot_energias_medida()
energia_anual_est
energia_anual_med
barplot_energias_estandar<-function(){
tabla_energia_est<-as.data.frame(matrix(unlist(lapply(lista_energias,"[",,4), use.names = F), byrow = F,ncol = 5))
names(tabla_energia_est)<- names(lista_energias)
row.names(tabla_energia_est)<- names(distribuciones_velocidad_anual)
path_here<-paste0(here(),"/barplot/")
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =200, shape=22, size=5, alpha=.5,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =180, shape=22, size=5, alpha=.4,fill='pink',color='red')+
geom_point(x=25, y =160, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =140, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =120, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 200)+
annotate("text",label="Concentrador 45º", x = 30, y = 180)+
annotate("text",label="Concentrador 70º", x = 30, y = 160)+
annotate("text",label="Pared", x = 27.5, y = 140)+
annotate("text",label="Piloto", x = 27.5, y = 120)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones \n usando las curvas de potencia generadas con la velocidad estándar")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotenergíacomparativa_estandar.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
return(as.data.frame(colSums(tabla_energia_est)))
}
barplot_energias_medida<-function(){
tabla_energia_est<-as.data.frame(matrix(unlist(lapply(lista_energias,"[",,5), use.names = F), byrow = F,ncol = 5))
names(tabla_energia_est)<- names(lista_energias)
row.names(tabla_energia_est)<- names(distribuciones_velocidad_anual)
path_here<-paste0(here(),"/barplot/")
ggplot(tabla_energia_est)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador45),stat = "identity", alpha=.8,fill='pink',color='red',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador30),stat = "identity",alpha=.9,fill='lightblue',color='lightblue4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=concentrador70),stat = "identity",alpha=.7,fill='green2',color='green4', show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=paredNA),stat = "identity", alpha=.6,fill='mediumorchid1',color='mediumorchid4',show.legend = T)+
geom_bar(aes(x=as.numeric(row.names(tabla_energia_est)),y=pilotoNA),stat = "identity",alpha=.5,fill='orange',color='orange4', show.legend = T)+
xlab("Velocidad del viento (m/s)")+
ylab("Energía (W/h)") +
geom_point(x=25, y =1300, shape=22, size=5, alpha=.1,fill='pink',color='red')+
geom_point(x=25, y =1500, shape=22, size=5, alpha=.9,fill='lightblue',color='lightblue4')+
geom_point(x=25, y =1100, shape=22, size=5, alpha=.3,fill='green2',color='green4')+
geom_point(x=25, y =900, shape=22, size=5, alpha=.2,fill='mediumorchid1',color='mediumorchid4')+
geom_point(x=25, y =700, shape=22, size=5,alpha=.1,fill='orange',color='orange4')+
annotate("text",label="Concentrador 30º", x = 30, y = 1500)+
annotate("text",label="Concentrador 45º", x = 30, y = 1300)+
annotate("text",label="Concentrador 70º", x = 30, y = 1100)+
annotate("text",label="Pared", x = 27.5, y = 900)+
annotate("text",label="Piloto", x = 27.5, y = 700)+
ggtitle("Comparativa de las energías anuales producidas empleando las 5 configuraciones  \n usando las curvas de potencia generadas con la velocidad medida")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))
ggsave(paste0(path_here,"barplotenergíacomparativa_medida.tiff"), device = "tiff", dpi=1200,width =8, height =7, units = 'in')
return(as.data.frame(colSums(tabla_energia_est)))
}
energia_anual_est<-barplot_energias_estandar()
energia_anual_med<-barplot_energias_medida()
